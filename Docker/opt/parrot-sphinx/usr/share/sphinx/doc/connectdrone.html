

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How to connect to the simulated drone &mdash; Sphinx-Guide 1.8 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Take off and hints, drone by drone" href="drone-requirements.html" />
    <link rel="prev" title="First step" href="firststep.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sphinx-Guide
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Change logs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatissphinx.html">What is Parrot-Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="system-requirements.html">System requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="firststep.html">First step</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to connect to the simulated drone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wifi-link">Wifi link</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-connect-to-a-skycontroller">How to connect to a Skycontroller</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#virtual-ethernet">Virtual ethernet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bluetooth">Bluetooth</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drone-requirements.html">Take off and hints, drone by drone</a></li>
<li class="toctree-l1"><a class="reference internal" href="dronefile.html">Anatomy of a ‘.drone’ file</a></li>
<li class="toctree-l1"><a class="reference internal" href="worldfile.html">Anatomy of a ‘.world’ file</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">How to watch flight information</a></li>
<li class="toctree-l1"><a class="reference internal" href="pluginctrl_ifaces.html">Tuning of drone internals at runtime - interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="pluginctrl_howtos.html">Tuning of drone internals at runtime - Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Parrot-Sphinx license agreement</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="advanced_topics.html">Advanced topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sphinx-Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>How to connect to the simulated drone</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-to-connect-to-the-simulated-drone">
<h1>How to connect to the simulated drone<a class="headerlink" href="#how-to-connect-to-the-simulated-drone" title="Permalink to this headline">¶</a></h1>
<p>Once a simulation got launched, a drone is lying in the middle of the scene,
waiting to be connected by a <em>controller</em>.</p>
<p>Depending on the drone model, the connection is achieved using various physical
links. The table below shows the supported link(s) for each drone model.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>drone</p></th>
<th class="head"><p>virtual ethernet</p></th>
<th class="head"><p>wifi</p></th>
<th class="head"><p>bluetooth</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Airborne</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Anafi4k</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>Bebop</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>Bebop2</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>Disco</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>Mambo</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>Swing</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Bluegrass</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
</tbody>
</table>
<p>You might want to check the <a class="reference internal" href="drone-requirements.html"><span class="doc">Take off and hints, drone by drone</span></a> page for detailed
information on each drone requirements and capabilities.</p>
<div class="section" id="wifi-link">
<h2>Wifi link<a class="headerlink" href="#wifi-link" title="Permalink to this headline">¶</a></h2>
<p>Note that the wifi link is active only if:</p>
<ul class="simple">
<li><p>you have a wifi hardware compatible with Parrot-Sphinx (see
<a class="reference external" href="system-requirements.html#wifi">system requirements (wifi)</a>)</p></li>
<li><p>you properly set the XML element <code class="docutils literal notranslate"><span class="pre">stolen_interface</span></code> in the <code class="docutils literal notranslate"><span class="pre">drone</span></code> section
of your .drone file</p></li>
</ul>
<p>Parrot-Sphinx takes over the wifi interface and provides it to the simulated firmware.
The firmware runs an instance of hostapd, which creates a wifi Access Point.
Then, the simulated drone gets connectable by any wifi device implementing the
<a class="reference external" href="http://developer.parrot.com">ARDroneSDK3 or GroundSDK stack</a>.</p>
<p>The discovery works exactly the same way as for a real drone.
For example, to connect with a simulated Anafi, just choose the SSID
“Anafi_PC_xxxxxx”, where xxxxxx is a hashcode related to the wifi MAC address.</p>
<p>Once connected, the drone can be controlled exactly like in real life. Here is
what you get with Freeflight 6.</p>
<a class="reference internal image-reference" href="_images/freeflight6_flying.png"><img alt="_images/freeflight6_flying.png" src="_images/freeflight6_flying.png" style="width: 600px;" /></a>
<div class="section" id="how-to-connect-to-a-skycontroller">
<h3>How to connect to a Skycontroller<a class="headerlink" href="#how-to-connect-to-a-skycontroller" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="_images/skycontroller.png"><img alt="_images/skycontroller.png" src="_images/skycontroller.png" style="width: 200px;" /></a>
<p>In your .drone file, the drone description has to contain the following:</p>
<ul class="simple">
<li><p>the IP address provided in stolen_interface must be 192.168.42.1 so to be in
the same subnetwork as the Skycontroller.</p></li>
<li><p>Skycontrollers do not support 5GHz wifi bandwidth. Therefore, if your wifi
hardware does support this bandwidth, you need to force the use of 2.4 GHz
channel. To achieve that, just add the <code class="docutils literal notranslate"><span class="pre">wifi_channel</span></code> property with a value
arbitrarily taken between 1 and 13, as follows:</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;drone&gt;</span>
   ....
    <span class="nt">&lt;wifi_channel&gt;</span>6<span class="nt">&lt;/wifi_channel&gt;</span>
<span class="nt">&lt;/drone&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="virtual-ethernet">
<h2>Virtual ethernet<a class="headerlink" href="#virtual-ethernet" title="Permalink to this headline">¶</a></h2>
<p>Parrot-Sphinx creates a virtual ethernet interface on host side as well as in the
simulated drone. On host side, the interface is generally called <code class="docutils literal notranslate"><span class="pre">fd_veth0</span></code>
and has the IP address 10.202.0.254. On drone side, it is called <code class="docutils literal notranslate"><span class="pre">eth1</span></code> (see
‘interface’ element in the .drone file) and gets the IP address 10.202.0.1.</p>
<p>To use the virtual ethernet link, the controller application should run on the
host so that the local interface is accessible. If you really need to run the
controller application from another machine belonging to the same IP network,
you need to activate the port forwarding mode, by using the following command
line option.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sphinx --port-forwarding<span class="o">=</span>&lt;remote_machine_IP_address&gt; &lt;my.drone&gt;
</pre></div>
</div>
<p><em>Note</em>: Be aware that port forwarding only works if the required ports are not
already taken by another process running on the host.</p>
<p>Now, using the appropriate API, you just need to indicate to the SDK stack what
is the drone IP address to connect:</p>
<ul class="simple">
<li><p>either <code class="docutils literal notranslate"><span class="pre">10.202.0.1</span></code>, if the controller application is running directly on
the host.</p></li>
<li><p>or the IP address of the host, if the port forwarding mode is activated.</p></li>
</ul>
</div>
<div class="section" id="bluetooth">
<h2>Bluetooth<a class="headerlink" href="#bluetooth" title="Permalink to this headline">¶</a></h2>
<p>Several drone models only accept to be connected via a Bluetooth link. To be
able to connect by Bluetooth, you need a compatible Bluetooth hardware. Please
check the page
<a class="reference external" href="system-requirements.html#bluetooth">system requirements (bluetooth)</a> for
more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">drone</span></code> section of your .drone file needs an element <code class="docutils literal notranslate"><span class="pre">stolen_bdaddr</span></code>
properly set, meaning that it expects the Bluetooth MAC address of the host. You
can easily find it by entering the command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> hciconfig
<span class="go">    hci0:   Type: BR/EDR  Bus: USB</span>
<span class="go">    BD Address: 00:1A:7D:DA:71:03  ACL MTU: 310:10  SCO MTU: 64:8</span>
<span class="go">    UP RUNNING</span>
<span class="go">    RX bytes:676 acl:0 sco:0 events:47 errors:0</span>
<span class="go">    TX bytes:2703 acl:0 sco:0 commands:47 errors:0</span>
</pre></div>
</div>
<p>Once your .drone file is set and the Bluetooth hardware ready, just launch
Parrot-Sphinx. The simulated firmware should be connectable through Bluetooth Low
Energy from a device implementing
<a class="reference external" href="http://developer.parrot.com">ARDroneSDK3 or GroundSDK stack</a>.</p>
<p>Testing with Freeflight Mini is of course possible, exactly as if you were
trying to connect to a real drone.</p>
<a class="reference internal image-reference" href="_images/freeflightmini_discovery.png"><img alt="_images/freeflightmini_discovery.png" src="_images/freeflightmini_discovery.png" style="width: 480.0px; height: 270.0px;" /></a>
<p>To retrieve the bluetooth identifier (UUID) of the simulated drone, you must
first obtain the identifier of your running firmware instance:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> fdc list instances
</pre></div>
</div>
<p>Then, enter the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> fdc show instances &lt;instance_name&gt; <span class="p">|</span> grep cmdline <span class="p">|</span> sed <span class="s1">&#39;s/ /\n/g&#39;</span> <span class="p">|</span> awk -F<span class="o">=</span> <span class="s1">&#39;$1 ~ /ro.sphinx.btfriendlyname/{print $2}&#39;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="drone-requirements.html" class="btn btn-neutral float-right" title="Take off and hints, drone by drone" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="firststep.html" class="btn btn-neutral float-left" title="First step" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020, Parrot

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>